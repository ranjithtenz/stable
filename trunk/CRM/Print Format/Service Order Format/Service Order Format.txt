[{'modified_by': 'Administrator', 'name': 'Service Order Format', 'parent': None, 'creation': '2009-05-13 17:10:48', 'modified': '2009-09-07 11:00:24', 'module': 'CRM', 'doctype': 'Print Format', 'idx': None, 'parenttype': None, 'html': '<html>\n<head>\n<!--Other charges function-->\n<script>\n    var make_row = function(title,val,bold){\n    var bstart = \'<b>\'; var bend = \'</b>\';\n    return \'<tr><td style="width:40%">\'+(bold?bstart:\'\')+title+(bold?bend:\'\')+\'</td>\'\n              +\'<td style="width:15%;text-align:right">\'+doc.currency+\'</td>\'\n              +\'<td style="width:25%;text-align:right">\'+val+\'</td>\'\n              +\'</tr>\'\n  }\n\n  function get_other_charges(){\n    var cl = getchildren(\'RV Tax Detail\',doc.name,\'other_charges\');\n    var out=\'\';\n    out +=\'<div><table class="noborder" style="width:100%">\'\n          +make_row(\'Net Total\',fmt_money(convert_rate(doc.net_total)),1);\n    if(cl.length){\n      for(var i=0;i<cl.length;i++){\n        out += make_row(cl[i].description,fmt_money(convert_rate(cl[i].tax_amount)),0);\n      }\n    }\n    out +=make_row(\'Grand Total\',fmt_money(doc.grand_total_export),1)\n          +make_row(\'Rounded Total\',fmt_money(doc.rounded_total_export),1)\n    out +=\'</table></div>\'; \n    return out;\n  }\n      \n  function get_letter_head(){\n    var cp = locals[\'Control Panel\'][\'Control Panel\'];\n  \tif(cp.letter_head) {return cp.letter_head; }\n\n  }\n  \n  function convert_rate(val){\n    var new_val = flt(val)/flt(doc.conversion_rate);\n    return new_val;\n  }\n</script>\n</head>\n<body>\n<div style="border:1px solid black;padding:20px">\n<!--header-->\n<div><script>get_letter_head()</script></div>\n<div style="border-bottom: 1px solid; padding-bottom: 5px;">\n <div><h3>Service Order</h3></div>\n <div><b>Service Order Number: <script>doc.name</script></b></div>\n <div>Date: <script>date.str_to_user(doc.transaction_date)</script></div>\n  <div>Ref Service Quotation: <script>doc.quotation_no</script></div>\n</div>\n\n<div style="padding-top:10px">\n<br>\n<script>doc.customer_name</script>\n<div><script>replace_newlines(doc.customer_address)</script></div>\n</div>\n\n<div>\n<br>\n    <script>\n    var t = print_table(\'Service Order\', doc.name, \'service_order_details\', \'Service Order Detail\', [\'SR\', \'article_no\',\'item_code\',\'qty\',\'basic_rate\',\'amount\'], [\'Sr\', \'Article No\', \'Catalogue Code\', \'Quantity\',\'Rate\',\'Amount\'], [\'5%\',\'15%\', \'40%\', \'10%\', \'15%\',\'15%\'])\n    if(t.appendChild) {\n      // single\n      out = t.innerHTML;\n    } \n    else {//multiple\n      out = \'\'\n      for(var i=0;i<t.length;i++) {\n        if(i!=t.length-1){\n          out += \'<div style:"padding-top:5px;"></div>\' + t[i].innerHTML +\'<div style="page-break-after:always"></div>\';\n        }\n        else out += \'<div style:"padding-top:5px;"></div>\' + t[i].innerHTML;\n      }\n    }\n    out;\n    </script>\n\n</div>\n\n<!--Other charges table-->\n<div>\n<table style="width:100%">\n  <tr><td style="width:65%"></td><td style="width:35%"><script>get_other_charges()</script></td></tr>\n  <tr><td style="width:65%"></td><td style="width:35%"><table><tr><td style="width:40%"><b>In Words</b></td><td style="width:60%"><script>doc.in_words</script></td></tr></table></td></tr>\n</table>\n</div>\n\n<div><br>Payment Terms</div>\n<div><br><script>replace_newlines(doc.payment_terms)</script></div>\n<div><br>For NCSCI</div>\n<div><br><br>(Authorised Signatory)</div>\n</div></body>\n</html>', 'owner': 'Administrator', 'docstatus': 0, 'standard': 'Yes', 'parentfield': None}]